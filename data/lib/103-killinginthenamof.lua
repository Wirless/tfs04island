-- TASK


RANK_NONE = 0
RANK_HUNTSMAN = 1
RANK_RANGER = 2
RANK_BIGGAMEHUNTER = 3
RANK_TROPHYHUNTER = 4
RANK_ELITEHUNTER = 5

REWARD_MONEY = 1
REWARD_EXP = 2
REWARD_ACHIEVEMENT = 3
REWARD_STORAGE = 4
REWARD_POINT = 5
REWARD_ITEM = 6

QUESTSTORAGE_BASE = 71500
KILLSSTORAGE_BASE = 72500
REPEATSTORAGE_BASE = 73500
POINTSSTORAGE = 72500
ONTASKSTORAGE = 74500
tasks =
{
[1] = {killsRequired = 200, raceName = "Bog Raiders", level = {4000, 9990}, premium = false, creatures = {"bog raider"}, rewards = {
{type = "exp", value = {50000}},
{type = "money", value = {10000}},
{type = "item", value = {5829,1}},
{type = "storage", value = {35000, 1}}
}},
[2] = {killsRequired = 100, raceName = "Dwarfs", level = {6, 30}, premium = false, creatures = {"dwarf","dwarf soldier","dwarf guard"}, rewards = {
{type = "exp", value = {15000}},
{type = "money", value = {10000}},
{type = "item", value = {2157,2}},
{type = "storage", value = {35001, 1}}
}},
[3] = {killsRequired = 100, raceName = "Undeads", level = {6, 40}, premium = false, creatures = {"ghoul","skeleton"}, rewards = {
{type = "exp", value = {50000}},
{type = "money", value = {5000}},
{type = "item", value = {2157,3}},
{type = "storage", value = {35002, 1}}
}},
[4] = {killsRequired = 100, raceName = "Larvas and Scarabs", level = {60, 40}, premium = false, creatures = {"larva","scarab"}, rewards = {
{type = "exp", value = {50000}},
{type = "money", value = {5000}},
{type = "item", value = {2157,5}},
{type = "storage", value = {35004, 1}}
}},
[5] = {killsRequired = 100, raceName = "Minotaurs", level = {6, 40}, premium = false, creatures = {"minotaur","minotaur guard","minotaur archer","minotaur mage"}, rewards = {
{type = "exp", value = {50000}},
{type = "money", value = {10000}},
{type = "item", value = {2157,2}},
{type = "storage", value = {35005, 1}}
}},
[6] = {killsRequired = 100, raceName = "Rotworms", level = {6, 30}, premium = false, creatures = {"rotworm"}, rewards = {
{type = "exp", value = {35000}},
{type = "money", value = {5000}},
{type = "item", value = {2157,2}},
{type = "storage", value = {35006, 1}}
}},
[7] = {killsRequired = 200, raceName = "Orcs", level = {6, 60}, premium = false, creatures = {"orc","orc spearman","orc shaman","orc warrior","orc warlord","orc berserker","orc raider"}, rewards = {
{type = "exp", value = {150000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35007, 1}}
}},
[8] = {killsRequired = 100, raceName = "Demon Skeletons", level = {25, 50}, premium = false, creatures = {"demon skeleton"}, rewards = {
{type = "exp", value = {100000}},
{type = "money", value = {10000}},
{type = "item", value = {2157,3}},
{type = "storage", value = {35016, 1}}
}},
[9] = {killsRequired = 50, raceName = "Trolls", level = {6, 30}, premium = false, creatures = {"troll","frost troll","swamp troll"}, rewards = {
{type = "exp", value = {15000}},
{type = "money", value = {3000}},
{type = "item", value = {2157,1}},
{type = "storage", value = {35011, 1}}
}},
[10] = {killsRequired = 100, raceName = "Ancient Scarabs", level = {4000, 9990}, premium = false, creatures = {"ancient scarab"}, rewards = {
{type = "exp", value = {150000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,5}},
{type = "storage", value = {35012, 1}}
}},
[11] = {killsRequired = 150, raceName = "Cyclops", level = {8, 50}, premium = false, creatures = {"cyclops"}, rewards = {
{type = "exp", value = {200000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,8}},
{type = "storage", value = {35015, 1}}
}},
[12] = {killsRequired = 100, raceName = "Dragons", level = {30, 90}, premium = false, creatures = {"dragon"}, rewards = {
{type = "exp", value = {150000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,15}},
{type = "storage", value = {35017, 1}}
}},
[13] = {killsRequired = 300, raceName = "Ghastly Dragons", level = {4000, 9990}, premium = false, creatures = {"ghastly dragon"}, rewards = {
{type = "exp", value = {300000}},
{type = "money", value = {50000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35018, 1}}
}},
[14] = {killsRequired = 100, raceName = "Giant Spiders", level = {30, 100}, premium = false, creatures = {"giant spider"}, rewards = {
{type = "exp", value = {200000}},
{type = "money", value = {25000}},
{type = "item", value = {2157,15}},
{type = "item", value = {2169,1}},
{type = "storage", value = {35020, 1}}
}},
[15] = {killsRequired = 100, raceName = "Heroes", level = {4000, 9990}, premium = false, creatures = {"hero"}, rewards = {
{type = "exp", value = {200000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,15}},
{type = "storage", value = {35021, 1}}
}},
[16] = {killsRequired = 100, raceName = "Necromancers", level = {20, 90}, premium = false, creatures = {"necromancer"}, rewards = {
{type = "exp", value = {200000}},
{type = "item", value = {2195,1}},
{type = "money", value = {0}},
{type = "item", value = {2157,9}},
{type = "storage", value = {35023, 1}}
}},
[17] = {killsRequired = 100, raceName = "Vampires", level = {4000, 9990}, premium = false, creatures = {"vampire"}, rewards = {
{type = "exp", value = {180000}},
{type = "money", value = {20000}},
{type = "item", value = {2534,1}},
{type = "item", value = {2157,5}},
{type = "storage", value = {35025, 1}}
}},
[18] = {killsRequired = 100, raceName = "Behemoths", level = {60, 999}, premium = false, creatures = {"behemoth"}, rewards = {
{type = "exp", value = {400000}},
{type = "money", value = {40000}},
{type = "item", value = {2645,1}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35026, 1}}
}},
[19] = {killsRequired = 100, raceName = "Dragon Lords", level = {40, 180}, premium = false, creatures = {"dragon lord"}, rewards = {
{type = "exp", value = {250000}},
{type = "money", value = {40000}},
{type = "item", value = {2157,5}},
{type = "storage", value = {35027, 1}}
}},
[20] = {killsRequired = 100, raceName = "Hydras", level = {40, 90}, premium = false, creatures = {"hydra"}, rewards = {
{type = "exp", value = {250000}},
{type = "money", value = {50000}},
{type = "item", value = {2197,5}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35028, 1}}
}},
[21] = {killsRequired = 100, raceName = "Serpent Spawns", level = {4000, 9990}, premium = false, creatures = {"serpent spawn"}, rewards = {
{type = "exp", value = {150000}},
{type = "money", value = {30000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35029, 1}}
}},
[22] = {killsRequired = 100, raceName = "Warlocks", level = {60, 125}, premium = false, creatures = {"warlock"}, rewards = {
{type = "exp", value = {500000}},
{type = "money", value = {70000}},
{type = "item", value = {2123,1}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35030, 1}}
}},
[23] = {killsRequired = 200, raceName = "Demons", level = {80, 999}, premium = false, creatures = {"demon"}, rewards = {
{type = "exp", value = {2000000}},
{type = "item", value = {2495,1}},
{type = "money", value = {100000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35031, 1}}
}},
[24] = {killsRequired = 100, raceName = "Hellfire Fighters", level = {4000, 9990}, premium = false, creatures = {"hellfire fighter"}, rewards = {
{type = "exp", value = {700000}},
{type = "money", value = {60000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35039, 1}}
}},
[25] = {killsRequired = 100, raceName = "Undead Dragons", level = {4000, 9990}, premium = false, creatures = {"undead dragon"}, rewards = {
{type = "exp", value = {1500000}},
{type = "money", value = {60000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35067, 1}}
}},
[26] = {killsRequired = 100, raceName = "Banshee", level = {70, 999}, premium = false, creatures = {"banshee"}, rewards = {
{type = "exp", value = {200000}},
{type = "money", value = {20000}},
{type = "item", value = {2659,1}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35046, 1}}
}},
[27] = {killsRequired = 300, raceName = "Apes", level = {4000, 9990}, premium = false, creatures = {"sibang","kongra","merlkin"}, rewards = {
{type = "exp", value = {500000}},
{type = "money", value = {20000}},
{type = "storage", value = {35013, 1}}
}},
[28] = {killsRequired = 100, raceName = "Frost Dragon", level = {4000, 9990}, premium = false, creatures = {"frost dragon"}, rewards = {
{type = "exp", value = {250000}},
{type = "money", value = {40000}},
{type = "item", value = {2157,10}},
{type = "item", value = {5728,1}},
{type = "storage", value = {35066, 1}}
}},
[29] = {killsRequired = 200, raceName = "Grim reapers", level = {4000, 9990}, premium = false, creatures = {"grim reaper"}, rewards = {
{type = "exp", value = {1000000}},
{type = "money", value = {100000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35065, 1}}
}},
[30] = {killsRequired = 300, raceName = "Lizards", level = {4000, 9990}, premium = false, creatures = {"lizard high guard","lizard dragon priest","lizard chosen"}, rewards = {
{type = "exp", value = {1000000}},
{type = "money", value = {100000}},
{type = "item", value = {2157,10}},
{type = "item", value = {5811,1}},
{type = "storage", value = {35068, 1}}
}},
[31] = {killsRequired = 200, raceName = "Medusa", level = {4000, 9999}, premium = false, creatures = {"medusa"}, rewards = {
{type = "exp", value = {500000}},
{type = "money", value = {50000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35072, 1}}
}},
[32] = {killsRequired = 400, raceName = "Nightmares", level = {4000, 9999}, premium = false, creatures = {"nightmare"}, rewards = {
{type = "exp", value = {500000}},
{type = "money", value = {50000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35072, 1}}
}},
[33] = {killsRequired = 100, raceName = "Sea serpents", level = {4000, 9990}, premium = false, creatures = {"sea serpent"}, rewards = {
{type = "exp", value = {100000}},
{type = "money", value = {20000}},
{type = "item", value = {2157,10}},
{type = "storage", value = {35073, 1}}
}},
[34] = {killsRequired = 100, raceName = "Goblins", level = {6, 30}, premium = false, creatures = {"goblin"}, rewards = {
{type = "exp", value = {15000}},
{type = "money", value = {2000}},
{type = "item", value = {2157,1}},
{type = "storage", value = {35011, 1}}
}},
}

tasksByPlayer = 3
repeatTimes = 1

function getPlayerRank(cid)
return (getPlayerStorageValue(cid, POINTSSTORAGE) >= 100 and RANK_ELITEHUNTER or getPlayerStorageValue(cid, POINTSSTORAGE) >= 70 and RANK_TROPHYHUNTER or getPlayerStorageValue(cid, POINTSSTORAGE) >= 40 and RANK_BIGGAMEHUNTER or getPlayerStorageValue(cid, POINTSSTORAGE) >= 20 and RANK_RANGER or getPlayerStorageValue(cid, POINTSSTORAGE) >= 10 and RANK_HUNTSMAN or RANK_NONE)
end

function getTaskByName(name, table)
local t = (table and table or tasks)
for k, v in pairs(t) do
if v.name then
if v.name:lower() == name:lower() then
return k
end
else
if v.raceName:lower() == name:lower() then
return k
end
end
end
return false
end

function getTasksByPlayer(cid)
local canmake = {}
local able = {}
for k, v in pairs(tasks) do
if getPlayerStorageValue(cid, QUESTSTORAGE_BASE + k) < 1 and getPlayerStorageValue(cid, REPEATSTORAGE_BASE + k) < repeatTimes then
able[k] = true
if getPlayerLevel(cid) < v.level[1] or getPlayerLevel(cid) > v.level[2] then
able[k] = false
end
if v.storage and getPlayerStorageValue(cid, v.storage[1]) < v.storage[2] then
able[k] = false
end

if v.rank then
if getPlayerRank(cid) < v.rank then
able[k] = false
end
end

if v.premium then
if not isPremium(cid) then
able[k] = false
end
end

if able[k] then
table.insert(canmake, k)
end
end
end
return canmake
end


function canStartTask(cid, name, table)
local v = ""
local id = 0
local t = (table and table or tasks)
for k, i in pairs(t) do
if i.name then
if i.name:lower() == name:lower() then
v = i
id = k
break
end
else
if i.raceName:lower() == name:lower() then
v = i
id = k
break
end
end
end
if v == "" then
return false
end
if getPlayerStorageValue(cid, QUESTSTORAGE_BASE + id) > 0 then
return false
end
if (getPlayerStorageValue(cid, REPEATSTORAGE_BASE + id) >= repeatTimes) or (v.norepeatable and getPlayerStorageValue(cid, REPEATSTORAGE_BASE + id) > 0) then
return false
end
if getPlayerLevel(cid) >= v.level[1] and getPlayerLevel(cid) <= v.level[2] then
if v.premium then
if isPremium(cid) then
if v.rank then
if getPlayerRank(cid) >= v.rank then
if v.storage then
if getPlayerStorageValue(cid, v.storage[1]) >= v.storage[2] then
return true
end
else
return true
end
end
else
return true
end
end
else
return true
end
end
return false
end

function getPlayerStartedTasks(cid)

local tmp = {}
for k, v in pairs(tasks) do
if getPlayerStorageValue(cid, QUESTSTORAGE_BASE + k) > 0 and getPlayerStorageValue(cid, QUESTSTORAGE_BASE + k) < 2 then
table.insert(tmp, k)
end
end
return tmp
end

function isSummon(target)
return (getCreatureMaster(target) ~= target)
end

